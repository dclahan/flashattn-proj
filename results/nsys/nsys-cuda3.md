=== GPU Information ===
Name: NVIDIA TITAN V
Compute Capability: 7.0
Global Memory: 11.7679 GB
Shared Memory per Block: 48 KB
Registers per Block: 65536
Warp Size: 32
Max Threads per Block: 1024
Max Threads per SM: 2048
Number of SMs: 80
=================================

# Naive Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     59.1    1,563,816,626         30   52,127,220.9   37,205,159.5       56,492  162,314,227  51,892,164.2  poll                  
     37.8    1,000,149,975          2  500,074,987.5  500,074,987.5  500,067,315  500,082,660      10,850.6  pthread_cond_timedwait
      2.9       75,593,345        847       89,248.3       19,221.0        1,382   29,597,405   1,032,259.2  ioctl                 
      0.1        3,922,602         45       87,168.9       12,615.0        9,313    2,956,021     438,064.9  mmap64                
      0.0        1,088,476          3      362,825.3      257,541.0      242,545      588,390     195,488.6  pthread_create        
      0.0          658,796         74        8,902.6        8,191.5        4,571       31,164       3,665.9  open64                
      0.0          484,444         18       26,913.6        7,589.5        2,586      254,577      59,403.3  mmap                  
      0.0          480,222         43       11,168.0        7,140.0        2,665       67,238      11,896.8  fopen                 
      0.0          389,386         36       10,816.3       11,498.5        1,728       38,871       7,497.8  fclose                
      0.0          361,866         14       25,847.6       25,792.5       15,674       42,135       7,639.8  sem_timedwait         
      0.0          126,951         93        1,365.1        1,330.0        1,055        3,280         287.2  fcntl                 
      0.0           75,421          1       75,421.0       75,421.0       75,421       75,421           0.0  fgets                 
      0.0           71,105          8        8,888.1        8,487.0        6,323       12,409       2,448.9  munmap                
      0.0           49,208          6        8,201.3        8,954.0        3,743       11,718       3,139.3  open                  
      0.0           46,527         16        2,907.9        3,005.0        1,974        3,780         565.5  write                 
      0.0           37,203          2       18,601.5       18,601.5       12,074       25,129       9,231.3  socket                
      0.0           34,187         19        1,799.3        1,388.0        1,301        4,470         880.9  read                  
      0.0           33,776         17        1,986.8        1,444.0        1,299        6,230       1,470.2  putc                  
      0.0           32,587          2       16,293.5       16,293.5        9,321       23,266       9,860.6  fread                 
      0.0           25,094          3        8,364.7        2,970.0        2,437       19,687       9,809.0  fwrite                
      0.0           20,915          3        6,971.7        8,268.0        4,194        8,453       2,407.3  pipe2                 
      0.0           16,021         12        1,335.1        1,313.5        1,119        1,779         175.5  dup                   
      0.0           15,818          1       15,818.0       15,818.0       15,818       15,818           0.0  connect               
      0.0            4,474          2        2,237.0        2,237.0        2,178        2,296          83.4  pthread_cond_broadcast
      0.0            4,069          2        2,034.5        2,034.5        1,959        2,110         106.8  pthread_mutex_trylock 
      0.0            3,287          1        3,287.0        3,287.0        3,287        3,287           0.0  bind                  
      0.0            2,039          1        2,039.0        2,039.0        2,039        2,039           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)    Min (ns)    Max (ns)     StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  ------------  ---------  -----------  -------------  ----------------------
     91.8    1,355,569,951          5  271,113,990.2  26,163,133.0     32,543  678,807,383  352,991,908.8  cudaDeviceSynchronize 
      7.5      110,315,220          7   15,759,317.1     131,207.0     89,661  109,415,128   41,298,442.6  cudaMalloc            
      0.4        5,773,460          3    1,924,486.7   1,928,211.0  1,898,995    1,946,254       23,848.6  cudaMemcpy            
      0.3        3,785,613          6      630,935.5     123,037.0     77,705    3,081,857    1,203,501.3  cudaFree              
      0.0          627,614          5      125,522.8      46,308.0     22,796      296,768      130,623.7  cudaLaunchKernel      
      0.0            1,748          1        1,748.0       1,748.0      1,748        1,748            0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)       Med (ns)      Min (ns)     Max (ns)     StdDev (ns)                                   Name                                 
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -------------  ---------------------------------------------------------------------
     52.0      704,940,788          2  352,470,394.0  352,470,394.0   26,162,312  678,778,476  461,469,315.1  matrix_multiply(const float *, const float *, float *, int, int, int)
     46.9      635,796,932          1  635,796,932.0  635,796,932.0  635,796,932  635,796,932            0.0  matrix_softmax(float *, int, int)                                    
      1.1       14,763,796          1   14,763,796.0   14,763,796.0   14,763,796   14,763,796            0.0  array_divide(float *, float, int)                                    
      0.0           33,696          1       33,696.0       33,696.0       33,696       33,696            0.0  matrix_transpose(const float *, float *, int, int)                   

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  ---------  ---------  -----------  ----------------------------
    100.0        5,133,423      3  1,711,141.0  1,707,728.0  1,702,960  1,722,735     10,319.8  [CUDA memcpy Host-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
     25.166      3     8.389     8.389     8.389     8.389        0.000  [CUDA memcpy Host-to-Device]

Generated:
    /home/dgc9773/gpu/proj/flashattn-proj/src/report1.nsys-rep
    /home/dgc9773/gpu/proj/flashattn-proj/src/report1.sqlite


# Flash Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)     Med (ns)    Min (ns)   Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  ------------  -----------  --------  -----------  ------------  ----------------------
     75.7      250,670,291         17  14,745,311.2  2,464,082.0     2,029  149,997,083  36,798,343.6  poll                  
     21.9       72,722,208        856      84,955.9     19,126.0     1,383   30,285,598   1,043,670.5  ioctl                 
      1.1        3,649,624         45      81,102.8     11,950.0     9,358    2,673,190     395,949.6  mmap64                
      0.4        1,454,586          3     484,862.0    572,052.0   269,475      613,059     187,654.1  pthread_create        
      0.2          630,209         74       8,516.3      8,038.0     4,415       19,068       2,333.3  open64                
      0.1          394,711         14      28,193.6     26,874.5    18,466       50,383       8,276.2  sem_timedwait         
      0.1          377,795         17      22,223.2     10,300.0     2,465      148,411      36,894.5  mmap                  
      0.1          376,869         36      10,468.6     11,475.5     1,789       39,082       7,435.0  fclose                
      0.1          363,631         43       8,456.5      6,339.0     2,605       33,406       5,835.5  fopen                 
      0.0          126,498         93       1,360.2      1,353.0     1,070        2,316         204.5  fcntl                 
      0.0          117,131          1     117,131.0    117,131.0   117,131      117,131           0.0  pthread_cond_wait     
      0.0           75,608          1      75,608.0     75,608.0    75,608       75,608           0.0  fgets                 
      0.0           47,478          6       7,913.0      7,775.0     5,885       10,156       1,723.4  munmap                
      0.0           45,310          6       7,551.7      8,064.5     3,650       10,913       2,754.6  open                  
      0.0           43,965         16       2,747.8      2,888.5     1,531        3,787         585.1  write                 
      0.0           43,919          2      21,959.5     21,959.5    18,968       24,951       4,230.6  socket                
      0.0           34,329         19       1,806.8      1,397.0     1,305        4,142         808.3  read                  
      0.0           33,669         17       1,980.5      1,477.0     1,314        5,786       1,390.5  putc                  
      0.0           32,487          2      16,243.5     16,243.5     9,154       23,333      10,026.1  fread                 
      0.0           19,022          3       6,340.7      7,007.0     4,349        7,666       1,756.0  pipe2                 
      0.0           16,453         12       1,371.1      1,328.5     1,130        1,667         188.2  dup                   
      0.0           13,682          1      13,682.0     13,682.0    13,682       13,682           0.0  connect               
      0.0           11,313          3       3,771.0      3,259.0     2,092        5,962       1,985.2  fwrite                
      0.0            4,698          2       2,349.0      2,349.0     2,181        2,517         237.6  pthread_cond_broadcast
      0.0            2,987          1       2,987.0      2,987.0     2,987        2,987           0.0  bind                  
      0.0            2,272          1       2,272.0      2,272.0     2,272        2,272           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)     Med (ns)    Min (ns)    Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  ------------  -----------  ---------  -----------  ------------  ----------------------
     89.2      108,902,951          8  13,612,868.9     98,728.0      3,793  108,292,907  38,256,529.2  cudaMalloc            
      5.5        6,661,687          1   6,661,687.0  6,661,687.0  6,661,687    6,661,687           0.0  cudaDeviceSynchronize 
      4.7        5,775,104          4   1,443,776.0  1,900,036.0     55,131    1,919,901     925,887.7  cudaMemcpy            
      0.4          532,681          6      88,780.2     85,481.5      6,966      141,722      48,837.3  cudaFree              
      0.1          146,497          1     146,497.0    146,497.0    146,497      146,497           0.0  cudaLaunchKernel      
      0.0           47,417          3      15,805.7      9,564.0      7,184       30,669      12,926.9  cudaMemset            
      0.0              886          1         886.0        886.0        886          886           0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ----------------------------------------------------------------------------------------------------
    100.0        6,661,441          1  6,661,441.0  6,661,441.0  6,661,441  6,661,441          0.0  flash_attn_forward_kernel(const float *, const float *, const float *, int, int, int, int, int, intâ€¦

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     99.6        5,073,904      4  1,268,476.0  1,680,144.0    13,536  1,700,080    836,683.4  [CUDA memcpy Host-to-Device]
      0.4           18,525      3      6,175.0      1,759.0     1,759     15,007      7,648.7  [CUDA memset]               

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
     25.297      4     6.324     8.389     0.131     8.389        4.129  [CUDA memcpy Host-to-Device]
      8.651      3     2.884     0.131     0.131     8.389        4.767  [CUDA memset]               

Generated:
    /home/dgc9773/gpu/proj/flashattn-proj/src/report2.nsys-rep
    /home/dgc9773/gpu/proj/flashattn-proj/src/report2.sqlite