=== GPU Information ===
Name: NVIDIA GeForce GTX TITAN X
Compute Capability: 5.2
Global Memory: 11.9143 GB
Shared Memory per Block: 48 KB
Registers per Block: 65536
Warp Size: 32
Max Threads per Block: 1024
Max Threads per SM: 2048
Number of SMs: 24
=================================

# Naive Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     48.6   12,671,291,866        134   94,561,879.6  100,113,814.5        1,944  156,137,431  23,174,116.1  poll                  
     47.9   12,501,726,789         25  500,069,071.6  500,068,515.0  500,060,205  500,087,888       6,521.0  pthread_cond_timedwait
      3.5      912,782,846        678    1,346,287.4       14,706.5        1,385  858,169,094  32,960,449.0  ioctl                 
      0.0        2,252,867         40       56,321.7       13,655.5        9,664    1,285,494     202,953.5  mmap64                
      0.0          762,655          3      254,218.3      233,892.0      227,210      301,553      41,128.9  pthread_create        
      0.0          512,720         43       11,923.7        7,492.0        2,621      103,195      17,220.8  fopen                 
      0.0          497,740         62        8,028.1        7,705.5        4,375       14,878       2,015.4  open64                
      0.0          398,959         36       11,082.2       11,777.0        1,862       39,248       7,733.3  fclose                
      0.0          196,125          7       28,017.9       26,480.0       22,054       35,900       4,641.8  sem_timedwait         
      0.0          119,836          1      119,836.0      119,836.0      119,836      119,836           0.0  pthread_cond_wait     
      0.0           97,797         74        1,321.6        1,289.0        1,063        2,057         178.5  fcntl                 
      0.0           91,097          9       10,121.9        7,258.0        2,895       21,606       7,004.1  mmap                  
      0.0           75,802          1       75,802.0       75,802.0       75,802       75,802           0.0  fgets                 
      0.0           45,731          6        7,621.8        8,139.5        3,694       11,138       2,678.5  open                  
      0.0           36,028          2       18,014.0       18,014.0       12,801       23,227       7,372.3  socket                
      0.0           35,497         17        2,088.1        1,414.0        1,306        7,052       1,801.5  putc                  
      0.0           31,736          2       15,868.0       15,868.0        9,872       21,864       8,479.6  fread                 
      0.0           29,163          9        3,240.3        3,449.0        1,634        4,485         862.1  write                 
      0.0           24,307         12        2,025.6        1,649.5        1,328        4,065         921.7  read                  
      0.0           20,838          3        6,946.0        7,767.0        4,754        8,317       1,918.1  pipe2                 
      0.0           12,481          3        4,160.3        3,304.0        2,060        7,117       2,635.0  fwrite                
      0.0           12,191          1       12,191.0       12,191.0       12,191       12,191           0.0  connect               
      0.0            8,893          3        2,964.3        2,329.0        2,205        4,359       1,209.4  pthread_cond_broadcast
      0.0            7,366          5        1,473.2        1,459.0        1,276        1,653         139.4  dup                   
      0.0            4,180          2        2,090.0        2,090.0        1,975        2,205         162.6  pthread_mutex_trylock 
      0.0            2,911          1        2,911.0        2,911.0        2,911        2,911           0.0  bind                  
      0.0            2,074          1        2,074.0        2,074.0        2,074        2,074           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls     Avg (ns)        Med (ns)    Min (ns)     Max (ns)       StdDev (ns)             Name         
 --------  ---------------  ---------  ---------------  ------------  ---------  -------------  ---------------  ----------------------
     99.0   12,453,114,970          5  2,490,622,994.0  33,431,487.0  2,208,473  6,600,805,409  3,393,809,126.1  cudaDeviceSynchronize 
      0.8      106,651,746          7     15,235,963.7      84,216.0     77,473    104,975,146     39,573,513.4  cudaMalloc            
      0.1       14,961,967          6      2,493,661.2   3,163,595.0    264,622      3,577,834      1,302,108.5  cudaFree              
      0.0        5,838,152          3      1,946,050.7   1,944,060.0  1,924,023      1,970,069         23,087.5  cudaMemcpy            
      0.0        2,150,510          5        430,102.0     145,931.0     50,201      1,537,183        626,444.2  cudaLaunchKernel      
      0.0            1,543          1          1,543.0       1,543.0      1,543          1,543              0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances     Avg (ns)         Med (ns)        Min (ns)       Max (ns)       StdDev (ns)                                    Name                                 
 --------  ---------------  ---------  ---------------  ---------------  -------------  -------------  ---------------  ---------------------------------------------------------------------
     53.2    6,626,168,739          2  3,313,084,369.5  3,313,084,369.5     27,436,889  6,598,731,850  4,646,607,228.1  matrix_multiply(const float *, const float *, float *, int, int, int)
     46.5    5,789,190,376          1  5,789,190,376.0  5,789,190,376.0  5,789,190,376  5,789,190,376              0.0  matrix_softmax(float *, int, int)                                    
      0.3       33,432,968          1     33,432,968.0     33,432,968.0     33,432,968     33,432,968              0.0  array_divide(float *, float, int)                                    
      0.0          112,096          1        112,096.0        112,096.0        112,096        112,096              0.0  matrix_transpose(const float *, float *, int, int)                   

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  ---------  ---------  -----------  ----------------------------
    100.0        5,189,965      3  1,729,988.3  1,735,791.0  1,711,727  1,742,447     16,161.2  [CUDA memcpy Host-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
     25.166      3     8.389     8.389     8.389     8.389        0.000  [CUDA memcpy Host-to-Device]

Generated:
    /home/dgc9773/gpu/proj/flashattn-proj/src/report1.nsys-rep
    /home/dgc9773/gpu/proj/flashattn-proj/src/report1.sqlite

# Flash Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)     Med (ns)    Min (ns)   Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  ------------  -----------  --------  -----------  ------------  ----------------------
     85.4      249,913,587         10  24,991,358.7  5,782,307.5     2,369  149,779,802  45,760,474.9  poll                  
     12.7       37,209,616        677      54,962.5     14,615.0     1,423   13,351,178     519,681.9  ioctl                 
      0.8        2,219,832         40      55,495.8     13,680.0     9,023    1,210,255     192,204.9  mmap64                
      0.3          788,140          3     262,713.3    250,830.0   247,635      289,675      23,404.1  pthread_create        
      0.2          522,641         62       8,429.7      7,984.0     4,892       18,346       2,396.3  open64                
      0.2          508,626         43      11,828.5      6,425.0     2,619       93,473      15,380.2  fopen                 
      0.1          394,103         36      10,947.3     11,714.5     1,811       39,415       7,443.7  fclose                
      0.1          381,785          7      54,540.7     59,132.0    28,826       87,661      20,382.1  sem_timedwait         
      0.0          135,296          1     135,296.0    135,296.0   135,296      135,296           0.0  pthread_cond_wait     
      0.0          101,665          9      11,296.1     10,851.0     2,739       30,057       8,718.2  mmap                  
      0.0           99,078         74       1,338.9      1,280.5     1,065        2,773         234.8  fcntl                 
      0.0           82,600          1      82,600.0     82,600.0    82,600       82,600           0.0  fgets                 
      0.0           47,614          6       7,935.7      7,485.0     3,834       12,134       3,223.2  open                  
      0.0           46,890         17       2,758.2      2,203.0     1,468        7,463       1,701.7  putc                  
      0.0           40,124          2      20,062.0     20,062.0    18,768       21,356       1,830.0  socket                
      0.0           37,569          9       4,174.3      4,360.0     1,919        5,591       1,126.0  write                 
      0.0           35,286          2      17,643.0     17,643.0    10,800       24,486       9,677.5  fread                 
      0.0           35,074         12       2,922.8      3,024.0     1,230        5,585       1,355.9  read                  
      0.0           20,799          3       6,933.0      7,190.0     3,613        9,996       3,199.3  pipe2                 
      0.0           13,851          1      13,851.0     13,851.0    13,851       13,851           0.0  connect               
      0.0           12,722          3       4,240.7      3,748.0     2,133        6,841       2,392.4  fwrite                
      0.0           10,694          3       3,564.7      2,557.0     2,438        5,699       1,849.3  pthread_cond_broadcast
      0.0            7,753          5       1,550.6      1,487.0     1,402        1,817         170.3  dup                   
      0.0            3,843          1       3,843.0      3,843.0     3,843        3,843           0.0  bind                  
      0.0            2,229          1       2,229.0      2,229.0     2,229        2,229           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)            Name         
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  ------------  ----------------------
     66.2       85,216,915          8  10,652,114.4      81,899.0       3,421  84,686,214  29,914,311.1  cudaMalloc            
     26.0       33,493,667          1  33,493,667.0  33,493,667.0  33,493,667  33,493,667           0.0  cudaDeviceSynchronize 
      5.2        6,737,844          4   1,684,461.0   1,925,372.5     926,537   1,960,562     505,722.3  cudaMemcpy            
      1.5        1,934,904          6     322,484.0     352,854.5       6,938     558,960     260,674.7  cudaFree              
      1.0        1,348,972          1   1,348,972.0   1,348,972.0   1,348,972   1,348,972           0.0  cudaLaunchKernel      
      0.0           42,069          3      14,023.0       6,585.0       4,929      30,555      14,341.1  cudaMemset            
      0.0            1,150          1       1,150.0       1,150.0       1,150       1,150           0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------------------------------------------------------------------------
    100.0       32,460,345          1  32,460,345.0  32,460,345.0  32,460,345  32,460,345          0.0  flash_attn_forward_kernel(const float *, const float *, const float *, int, int, int, int, int, intâ€¦

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     99.3        5,186,932      4  1,296,733.0  1,718,993.0    13,345  1,735,601    855,634.2  [CUDA memcpy Host-to-Device]
      0.7           36,960      3     12,320.0      1,920.0     1,792     33,248     18,124.3  [CUDA memset]               

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
     25.297      4     6.324     8.389     0.131     8.389        4.129  [CUDA memcpy Host-to-Device]
      8.651      3     2.884     0.131     0.131     8.389        4.767  [CUDA memset]               

Generated:
    /home/dgc9773/gpu/proj/flashattn-proj/src/report2.nsys-rep
    /home/dgc9773/gpu/proj/flashattn-proj/src/report2.sqlite