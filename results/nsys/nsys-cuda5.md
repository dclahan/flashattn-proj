=== GPU Information ===
Name: NVIDIA GeForce RTX 4070
Compute Capability: 8.9
Global Memory: 11.595 GB
Shared Memory per Block: 48 KB
Registers per Block: 65536
Warp Size: 32
Max Threads per Block: 1024
Max Threads per SM: 1536
Number of SMs: 46
=================================

# Naive Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     60.6    1,139,457,199         62   18,378,341.9   10,069,643.5      143,812  185,674,373  29,521,212.9  poll                  
     26.6      500,062,609          1  500,062,609.0  500,062,609.0  500,062,609  500,062,609           0.0  pthread_cond_timedwait
     12.5      235,167,522        478      491,982.3       16,088.0        1,073   75,168,731   3,558,739.8  ioctl                 
      0.1        1,581,679         25       63,267.2       15,558.0       11,861      925,501     180,963.5  mmap64                
      0.0          831,282          3      277,094.0      144,113.0      101,715      585,454     267,887.7  pthread_create        
      0.0          683,907         28       24,425.3        9,709.5        2,571      159,377      40,756.4  fopen                 
      0.0          481,154         43       11,189.6       10,704.0        5,593       23,783       3,366.9  open64                
      0.0          454,403          9       50,489.2       44,887.0       33,444       76,975      15,906.3  sem_timedwait         
      0.0          244,524         16       15,282.8       10,666.5        2,912       69,013      15,846.2  mmap                  
      0.0          221,873         22       10,085.1       10,658.0        1,970       19,498       5,147.3  fclose                
      0.0           84,128         10        8,412.8        7,893.5        5,901       16,095       3,006.1  munmap                
      0.0           75,808         33        2,297.2        1,585.0        1,350        8,419       1,695.8  close                 
      0.0           66,685         48        1,389.3        1,267.5        1,086        2,687         357.6  fcntl                 
      0.0           66,107          1       66,107.0       66,107.0       66,107       66,107           0.0  fgets                 
      0.0           59,826         12        4,985.5        3,679.5        2,820       18,670       4,391.0  write                 
      0.0           53,737          6        8,956.2       10,028.0        4,373       12,113       3,102.2  open                  
      0.0           47,890          2       23,945.0       23,945.0       11,522       36,368      17,568.8  socket                
      0.0           41,561         15        2,770.7        2,617.0        1,725        5,253         951.8  read                  
      0.0           41,199         11        3,745.4        1,265.0        1,011       19,648       5,928.2  putc                  
      0.0           34,503          3       11,501.0       11,699.0        4,448       18,356       6,956.1  pipe2                 
      0.0           29,776          2       14,888.0       14,888.0       11,582       18,194       4,675.4  fread                 
      0.0           19,807          3        6,602.3        4,454.0        3,215       12,138       4,833.9  fwrite                
      0.0           14,463          1       14,463.0       14,463.0       14,463       14,463           0.0  connect               
      0.0           12,510          1       12,510.0       12,510.0       12,510       12,510           0.0  pthread_mutex_trylock 
      0.0            8,212          7        1,173.1        1,150.0        1,036        1,360         118.9  dup                   
      0.0            3,916          1        3,916.0        3,916.0        3,916        3,916           0.0  listen                
      0.0            3,824          1        3,824.0        3,824.0        3,824        3,824           0.0  bind                  
      0.0            1,307          1        1,307.0        1,307.0        1,307        1,307           0.0  fflush                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)     Med (ns)    Min (ns)    Max (ns)     StdDev (ns)                Name             
 --------  ---------------  ---------  ------------  -----------  ---------  -----------  -------------  ------------------------------
     90.9      451,676,373          7  64,525,196.1    151,891.0    102,736  450,637,090  170,259,360.0  cudaMalloc                    
      6.8       33,840,311          5   6,768,062.2      6,318.0      2,926   27,115,836   11,739,758.6  cudaDeviceSynchronize         
      1.6        7,823,078          3   2,607,692.7  2,598,789.0  2,580,926    2,643,363       32,156.7  cudaMemcpy                    
      0.7        3,466,325          5     693,265.0     10,962.0      2,904    3,402,738    1,514,746.9  cudaLaunchKernel              
      0.0          206,466          6      34,411.0      2,817.5      2,455      191,238       76,833.4  cudaFree                      
      0.0          110,863          1     110,863.0    110,863.0    110,863      110,863            0.0  cuLibraryLoadData             
      0.0            5,109          4       1,277.3        944.0        643        2,578          903.6  cuLibraryGetKernel            
      0.0            3,343          5         668.6        743.0        190          961          304.1  cuKernelGetName               
      0.0            1,105          1       1,105.0      1,105.0      1,105        1,105            0.0  cudaGetDeviceProperties_v12000
      0.0            1,065          1       1,065.0      1,065.0      1,065        1,065            0.0  cuModuleGetLoadingMode        

[6/8] Executing 'cuda_gpu_kern_sum' stats report
SKIPPED: /home/dgc9773/gpu/proj/flashattn-proj/src/report1.sqlite does not contain CUDA kernel data.
[7/8] Executing 'cuda_gpu_mem_time_sum' stats report
SKIPPED: /home/dgc9773/gpu/proj/flashattn-proj/src/report1.sqlite does not contain GPU memory data.
[8/8] Executing 'cuda_gpu_mem_size_sum' stats report
SKIPPED: /home/dgc9773/gpu/proj/flashattn-proj/src/report1.sqlite does not contain GPU memory data.
Generated:
        /home/dgc9773/gpu/proj/flashattn-proj/src/report1.nsys-rep
        /home/dgc9773/gpu/proj/flashattn-proj/src/report1.sqlite

# Flash Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     61.0    1,145,355,699         63   18,180,249.2   10,070,953.0       14,821  171,090,716  28,483,721.6  poll                  
     26.6      500,053,232          1  500,053,232.0  500,053,232.0  500,053,232  500,053,232           0.0  pthread_cond_timedwait
     12.1      227,016,622        488      465,198.0       15,799.0        1,045   74,474,706   3,465,477.1  ioctl                 
      0.1        1,568,928         25       62,757.1       14,909.0       12,545      881,989     172,404.0  mmap64                
      0.0          794,669          3      264,889.7      171,910.0      117,842      504,917     209,620.3  pthread_create        
      0.0          632,731          9       70,303.4       73,952.0       41,219       88,570      14,095.6  sem_timedwait         
      0.0          578,483         28       20,660.1        9,547.0        2,389      200,629      38,336.8  fopen                 
      0.0          484,959         43       11,278.1       10,320.0        5,900       22,925       3,423.6  open64                
      0.0          229,761         14       16,411.5        9,686.5        3,852       77,534      18,989.6  mmap                  
      0.0          203,402         22        9,245.5       10,342.0        1,881       18,632       4,584.0  fclose                
      0.0           85,693          1       85,693.0       85,693.0       85,693       85,693           0.0  pthread_cond_wait     
      0.0           78,095         33        2,366.5        1,632.0        1,431        7,762       1,778.7  close                 
      0.0           63,106         48        1,314.7        1,249.0        1,095        2,600         254.4  fcntl                 
      0.0           59,316          1       59,316.0       59,316.0       59,316       59,316           0.0  fgets                 
      0.0           50,776          4       12,694.0        8,534.5        7,221       26,486       9,259.2  munmap                
      0.0           50,726          6        8,454.3        8,713.5        4,090       12,390       2,992.7  open                  
      0.0           40,273         14        2,876.6        2,702.5        1,932        4,490         793.9  read                  
      0.0           37,108         11        3,373.5        3,184.0        1,966        5,997       1,011.8  write                 
      0.0           35,860          2       17,930.0       17,930.0       10,322       25,538      10,759.3  socket                
      0.0           31,116          2       15,558.0       15,558.0       11,042       20,074       6,386.6  fread                 
      0.0           27,866          3        9,288.7       10,367.0        4,752       12,747       4,105.1  pipe2                 
      0.0           26,053          9        2,894.8        1,267.0        1,018        9,059       3,287.2  putc                  
      0.0           20,618          7        2,945.4        1,220.0        1,129       13,245       4,542.3  dup                   
      0.0           15,044          1       15,044.0       15,044.0       15,044       15,044           0.0  connect               
      0.0           11,708          3        3,902.7        2,915.0        2,241        6,552       2,319.0  fwrite                
      0.0            3,653          1        3,653.0        3,653.0        3,653        3,653           0.0  pthread_cond_broadcast
      0.0            2,767          1        2,767.0        2,767.0        2,767        2,767           0.0  bind                  
      0.0            2,443          1        2,443.0        2,443.0        2,443        2,443           0.0  listen                
      0.0            1,320          1        1,320.0        1,320.0        1,320        1,320           0.0  fflush                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)     StdDev (ns)                Name             
 --------  ---------------  ---------  ------------  ------------  ----------  -----------  -------------  ------------------------------
     89.0      448,631,541          8  56,078,942.6     107,230.5       4,998  447,845,654  158,297,667.2  cudaMalloc                    
      6.9       34,568,110          1  34,568,110.0  34,568,110.0  34,568,110   34,568,110            0.0  cudaDeviceSynchronize         
      2.5       12,788,562          4   3,197,140.5   2,535,687.5   2,442,795    5,274,392    1,385,541.6  cudaMemcpy                    
      1.3        6,773,912          1   6,773,912.0   6,773,912.0   6,773,912    6,773,912            0.0  cudaLaunchKernel              
      0.2        1,111,991          6     185,331.8     228,339.5       8,620      252,090       96,123.5  cudaFree                      
      0.0           74,402          3      24,800.7      11,238.0       8,984       54,180       25,468.2  cudaMemset                    
      0.0           59,906          1      59,906.0      59,906.0      59,906       59,906            0.0  cuLibraryLoadData             
      0.0            1,532          2         766.0         766.0         754          778           17.0  cudaGetDeviceProperties_v12000
      0.0            1,093          1       1,093.0       1,093.0       1,093        1,093            0.0  cuModuleGetLoadingMode        
      0.0              615          1         615.0         615.0         615          615            0.0  cuKernelGetName               
      0.0              535          1         535.0         535.0         535          535            0.0  cuLibraryGetKernel            

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------------------------------------------------------------------------
    100.0       27,869,780          1  27,869,780.0  27,869,780.0  27,869,780  27,869,780          0.0  flash_attn_forward_kernel(const float *, const float *, const float *, int, int, int, int, int, intâ€¦

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)           Operation          
 --------  ---------------  -----  -----------  -----------  --------  ---------  -----------  ----------------------------
     99.8        6,720,723      4  1,680,180.8  2,224,443.5    12,448  2,259,388  1,111,972.4  [CUDA memcpy Host-to-Device]
      0.2           15,168      3      5,056.0      2,112.0     1,216     11,840      5,892.2  [CUDA memset]               

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
     25.297      4     6.324     8.389     0.131     8.389        4.129  [CUDA memcpy Host-to-Device]
      8.651      3     2.884     0.131     0.131     8.389        4.767  [CUDA memset]               

Generated:
        /home/dgc9773/gpu/proj/flashattn-proj/src/report2.nsys-rep
        /home/dgc9773/gpu/proj/flashattn-proj/src/report2.sqlite