=== GPU Information ===
Name: NVIDIA GeForce RTX 2080 Ti
Compute Capability: 7.5
Global Memory: 10.5683 GB
Shared Memory per Block: 48 KB
Registers per Block: 65536
Warp Size: 32
Max Threads per Block: 1024
Max Threads per SM: 1024
Number of SMs: 68
=================================

# Naive Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  ------------  ----------------------
     67.4    4,634,209,892        241   19,229,086.7   10,064,647.0        2,028  165,090,571  28,086,647.2  poll                  
     29.1    2,000,351,638          4  500,087,909.5  500,085,047.5  500,064,963  500,116,580      22,411.8  pthread_cond_timedwait
      3.4      231,379,413        683      338,769.3       16,500.0        1,142   84,625,397   3,271,030.9  ioctl                 
      0.0        1,794,944         31       57,901.4       13,341.0        8,125    1,166,425     206,317.2  mmap64                
      0.0        1,347,555          3      449,185.0      548,454.0      243,680      555,421     178,006.6  pthread_create        
      0.0          517,900         10       51,790.0       53,317.0       37,720       61,611       7,812.4  sem_timedwait         
      0.0          511,861         56        9,140.4        8,972.0        4,675       22,143       2,913.2  open64                
      0.0          410,443         43        9,545.2        7,998.0        2,260       35,905       6,691.5  fopen                 
      0.0          246,930         17       14,525.3       12,212.0        1,831       64,604      14,571.0  mmap                  
      0.0          130,606          1      130,606.0      130,606.0      130,606      130,606           0.0  pthread_cond_wait     
      0.0          115,501         36        3,208.4        2,858.5        1,285       13,137       2,127.4  fclose                
      0.0           68,459         58        1,180.3        1,152.5        1,010        2,191         172.3  fcntl                 
      0.0           58,886          1       58,886.0       58,886.0       58,886       58,886           0.0  fgets                 
      0.0           52,802          6        8,800.3        8,367.5        5,297       12,285       2,616.7  munmap                
      0.0           44,821         15        2,988.1        2,413.0        1,156       10,819       2,385.0  read                  
      0.0           41,461          6        6,910.2        7,605.5        3,047        9,987       2,556.7  open                  
      0.0           38,259         12        3,188.3        3,276.5        1,224        4,830         938.7  write                 
      0.0           34,830          2       17,415.0       17,415.0       12,015       22,815       7,636.8  socket                
      0.0           26,856          2       13,428.0       13,428.0       10,032       16,824       4,802.7  fread                 
      0.0           22,079          3        7,359.7        8,668.0        3,911        9,500       3,015.5  pipe2                 
      0.0           18,567          6        3,094.5        1,310.0        1,012        7,634       3,024.4  putc                  
      0.0           15,633          1       15,633.0       15,633.0       15,633       15,633           0.0  connect               
      0.0            8,685          3        2,895.0        2,620.0        2,002        4,063       1,057.7  fwrite                
      0.0            6,133          2        3,066.5        3,066.5        2,852        3,281         303.3  pthread_cond_broadcast
      0.0            4,395          3        1,465.0        1,425.0        1,420        1,550          73.7  pthread_mutex_trylock 
      0.0            3,609          3        1,203.0        1,233.0        1,009        1,367         180.9  dup                   
      0.0            3,361          1        3,361.0        3,361.0        3,361        3,361           0.0  bind                  
      0.0            1,881          1        1,881.0        1,881.0        1,881        1,881           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)       Med (ns)    Min (ns)     Max (ns)      StdDev (ns)            Name         
 --------  ---------------  ---------  -------------  ------------  ---------  -------------  -------------  ----------------------
     89.9    2,176,071,211          5  435,214,242.2  28,103,321.0     68,081  1,584,808,248  682,598,486.5  cudaDeviceSynchronize 
      9.7      233,650,943          7   33,378,706.1     164,978.0    155,240    232,344,384   87,735,670.3  cudaMalloc            
      0.3        6,999,883          6    1,166,647.2   1,027,759.5    208,031      3,004,607      959,465.2  cudaFree              
      0.1        3,140,833          3    1,046,944.3   1,052,405.0  1,016,012      1,072,416       28,595.8  cudaMemcpy            
      0.0          542,123          5      108,424.6      45,433.0     29,321        237,846      100,580.4  cudaLaunchKernel      
      0.0            1,144          1        1,144.0       1,144.0      1,144          1,144            0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)       Med (ns)      Min (ns)      Max (ns)       StdDev (ns)                                    Name                                 
 --------  ---------------  ---------  -------------  -------------  -----------  -------------  ---------------  ---------------------------------------------------------------------
     74.1    1,612,880,076          2  806,440,038.0  806,440,038.0   28,102,896  1,584,777,180  1,100,734,942.3  matrix_multiply(const float *, const float *, float *, int, int, int)
     25.1      546,000,789          1  546,000,789.0  546,000,789.0  546,000,789    546,000,789              0.0  matrix_softmax(float *, int, int)                                    
      0.8       17,088,418          1   17,088,418.0   17,088,418.0   17,088,418     17,088,418              0.0  array_divide(float *, float, int)                                    
      0.0           72,192          1       72,192.0       72,192.0       72,192         72,192              0.0  matrix_transpose(const float *, float *, int, int)                   

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
    100.0        2,835,963      3  945,321.0  947,999.0   935,134   952,830      9,146.9  [CUDA memcpy Host-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
     25.166      3     8.389     8.389     8.389     8.389        0.000  [CUDA memcpy Host-to-Device]

Generated:
    /home/dgc9773/gpu/proj/flashattn-proj/src/report1.nsys-rep
    /home/dgc9773/gpu/proj/flashattn-proj/src/report1.sqlite

# Flash Attention
=================================
Configuration: B=32, nh=16, N=64, d=64
Total Q size: 8 MB

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)    Min (ns)   Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  ------------  ------------  --------  -----------  ------------  ----------------------
     73.5      641,874,546         40  16,046,863.7  10,065,213.0     1,959  165,415,709  28,639,302.2  poll                  
     25.9      226,410,114        691     327,655.7      16,858.0     1,042   84,724,085   3,254,595.5  ioctl                 
      0.2        1,765,478         31      56,950.9      12,922.0     7,892    1,158,410     204,954.2  mmap64                
      0.1          954,524          3     318,174.7     226,340.0   178,693      549,491     201,737.4  pthread_create        
      0.1          505,234         56       9,022.0       8,790.0     4,365       21,002       2,686.2  open64                
      0.1          449,768         10      44,976.8      45,872.0    24,790       59,425       9,601.0  sem_timedwait         
      0.0          408,293         43       9,495.2       7,589.0     1,995       36,618       6,781.3  fopen                 
      0.0          238,920         16      14,932.5      12,036.0     1,858       65,008      14,768.7  mmap                  
      0.0          109,772         36       3,049.2       2,868.0     1,278        9,730       1,522.3  fclose                
      0.0          105,998          1     105,998.0     105,998.0   105,998      105,998           0.0  pthread_cond_wait     
      0.0           67,556         58       1,164.8       1,125.0     1,005        2,141         173.8  fcntl                 
      0.0           59,136          1      59,136.0      59,136.0    59,136       59,136           0.0  fgets                 
      0.0           42,495          6       7,082.5       7,328.5     4,121        9,784       2,274.6  open                  
      0.0           41,657          6       6,942.8       6,927.5     4,424       10,652       2,371.9  munmap                
      0.0           38,634         15       2,575.6       2,566.0     1,008        4,822       1,210.2  read                  
      0.0           37,337         12       3,111.4       3,200.5     1,293        4,448         835.3  write                 
      0.0           35,281          2      17,640.5      17,640.5    12,475       22,806       7,305.1  socket                
      0.0           27,803          2      13,901.5      13,901.5    10,077       17,726       5,408.7  fread                 
      0.0           25,939         11       2,358.1       1,297.0     1,002        7,514       2,328.9  putc                  
      0.0           23,367          3       7,789.0       8,858.0     4,037       10,472       3,348.0  pipe2                 
      0.0           15,337          1      15,337.0      15,337.0    15,337       15,337           0.0  connect               
      0.0            8,394          3       2,798.0       2,512.0     2,074        3,808         901.7  fwrite                
      0.0            5,936          3       1,978.7       1,664.0     1,499        2,773         692.8  pthread_cond_broadcast
      0.0            5,789          5       1,157.8       1,133.0     1,047        1,320         117.5  dup                   
      0.0            3,173          1       3,173.0       3,173.0     3,173        3,173           0.0  bind                  
      0.0            1,835          1       1,835.0       1,835.0     1,835        1,835           0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls    Avg (ns)      Med (ns)     Min (ns)    Max (ns)    StdDev (ns)            Name         
 --------  ---------------  ---------  ------------  ------------  ----------  -----------  ------------  ----------------------
     93.4      232,760,448          8  29,095,056.0     174,381.0       4,268  231,775,443  81,895,268.9  cudaMalloc            
      4.8       12,085,312          1  12,085,312.0  12,085,312.0  12,085,312   12,085,312           0.0  cudaDeviceSynchronize 
      1.3        3,157,693          4     789,423.3   1,031,610.0      27,684    1,066,789     508,867.3  cudaMemcpy            
      0.4        1,119,471          6     186,578.5     216,004.5       6,102      285,813     115,311.8  cudaFree              
      0.1          159,479          1     159,479.0     159,479.0     159,479      159,479           0.0  cudaLaunchKernel      
      0.0           42,268          3      14,089.3       7,195.0       5,449       29,624      13,481.7  cudaMemset            
      0.0              943          1         943.0         943.0         943          943           0.0  cuModuleGetLoadingMode

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)      Med (ns)     Min (ns)    Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ------------  ------------  ----------  ----------  -----------  ----------------------------------------------------------------------------------------------------
    100.0       12,085,420          1  12,085,420.0  12,085,420.0  12,085,420  12,085,420          0.0  flash_attn_forward_kernel(const float *, const float *, const float *, int, int, int, int, int, intâ€¦

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)           Operation          
 --------  ---------------  -----  ---------  ---------  --------  --------  -----------  ----------------------------
     99.3        2,852,508      4  713,127.0  946,015.0    13,152   947,326    466,651.5  [CUDA memcpy Host-to-Device]
      0.7           18,784      3    6,261.3    1,952.0     1,728    15,104      7,658.8  [CUDA memset]               

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)           Operation          
 ----------  -----  --------  --------  --------  --------  -----------  ----------------------------
     25.297      4     6.324     8.389     0.131     8.389        4.129  [CUDA memcpy Host-to-Device]
      8.651      3     2.884     0.131     0.131     8.389        4.767  [CUDA memset]               

Generated:
    /home/dgc9773/gpu/proj/flashattn-proj/src/report2.nsys-rep
    /home/dgc9773/gpu/proj/flashattn-proj/src/report2.sqlite
